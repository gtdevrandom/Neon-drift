<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Geometry Dash Web</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #1e1e1e;
    font-family: sans-serif;
    color: #fff;
  }
  #gameCanvas {
    display: block;
    margin: 0 auto;
    background: linear-gradient(to bottom, #222, #111);
  }
  #score {
    position: absolute;
    top: 10px;
    left: 10px;
    font-size: 20px;
  }
</style>
</head>
<body>
<div id="score">Score: 0</div>
<canvas id="gameCanvas" width="800" height="400"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

const GRAVITY = 0.7;
const JUMP_STRENGTH = -12;
const PLAYER_SIZE = 30;
const OBSTACLE_WIDTH = 30;
const OBSTACLE_HEIGHT = 60;
const SPAWN_INTERVAL = 1500; // ms

let player = {
  x: 100,
  y: canvas.height - PLAYER_SIZE,
  vy: 0,
  onGround: true
};

let obstacles = [];
let score = 0;
let gameOver = false;

// Génération d'obstacles
function spawnObstacle() {
  let height = 30 + Math.random() * (OBSTACLE_HEIGHT);
  obstacles.push({ x: canvas.width, y: canvas.height - height, width: OBSTACLE_WIDTH, height: height });
}

// Saut du joueur
function jump() {
  if (player.onGround) {
    player.vy = JUMP_STRENGTH;
    player.onGround = false;
  }
}

// Collision simple AABB
function checkCollision(rect1, rect2) {
  return rect1.x < rect2.x + rect2.width &&
         rect1.x + PLAYER_SIZE > rect2.x &&
         rect1.y < rect2.y + rect2.height &&
         rect1.y + PLAYER_SIZE > rect2.y;
}

// Input
document.addEventListener('keydown', e => {
  if (e.code === 'Space') jump();
});
canvas.addEventListener('touchstart', jump);

// Game loop
let lastTime = 0;
function gameLoop(timestamp) {
  if (gameOver) return;
  let delta = timestamp - lastTime;
  lastTime = timestamp;

  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Gravité
  player.vy += GRAVITY;
  player.y += player.vy;

  if (player.y + PLAYER_SIZE >= canvas.height) {
    player.y = canvas.height - PLAYER_SIZE;
    player.vy = 0;
    player.onGround = true;
  }

  // Dessin du joueur
  ctx.fillStyle = '#00f';
  ctx.fillRect(player.x, player.y, PLAYER_SIZE, PLAYER_SIZE);

  // Gestion obstacles
  obstacles.forEach((obs, index) => {
    obs.x -= 5; // vitesse du jeu

    ctx.fillStyle = '#f00';
    ctx.fillRect(obs.x, obs.y, obs.width, obs.height);

    if (checkCollision(player, obs)) {
      gameOver = true;
      alert("Game Over! Score: " + score);
    }

    if (obs.x + obs.width < 0) obstacles.splice(index, 1);
  });

  // Score
  score += 1;
  document.getElementById('score').textContent = "Score: " + score;

  requestAnimationFrame(gameLoop);
}

// Spawn obstacles à intervalle régulier
setInterval(() => {
  if (!gameOver) spawnObstacle();
}, SPAWN_INTERVAL);

// Lancement du jeu
requestAnimationFrame(gameLoop);
</script>
</body>
</html>
